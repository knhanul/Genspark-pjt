# ⏱️ 타임스탬프 편집 가이드

## 개요
가사와 YouTube 영상의 싱크가 맞지 않을 때, UI에서 직접 타임스탬프를 조정할 수 있습니다.

---

## 🎯 사용 방법

### 1단계: 편집 모드 활성화
1. 곡을 선택하여 학습 화면으로 이동
2. 상단의 **"⚙️ 타임스탬프 편집"** 버튼 클릭
3. 버튼이 **"⚙️ 편집 중"** 상태로 변경됨
4. 각 가사 구절 옆에 **⚙️ 톱니바퀴** 버튼이 표시됨

### 2단계: 편집할 가사 선택
- 수정하려는 가사 구절의 **⚙️ 버튼** 클릭
- 타임스탬프 편집 모달 창이 열림

### 3단계: 시작 시간 설정
**방법 1: 현재 재생 시간 활용** (권장)
1. YouTube 영상을 해당 구절이 **시작되는 정확한 순간**으로 이동
2. 일시정지 (스페이스바 또는 재생 버튼)
3. 시작 시간 입력 필드 옆의 **"📍 현재 시간"** 버튼 클릭
4. 현재 재생 시간이 자동으로 입력됨

**방법 2: 직접 입력**
- 시작 시간 입력 필드에 직접 숫자 입력 (예: `14.5`)
- 소수점 첫째 자리까지 입력 (0.1초 단위)

### 4단계: 종료 시간 설정
**방법 1: 현재 재생 시간 활용** (권장)
1. YouTube 영상을 해당 구절이 **끝나는 순간**으로 이동
2. 일시정지
3. 종료 시간 입력 필드 옆의 **"📍 현재 시간"** 버튼 클릭

**방법 2: 직접 입력**
- 종료 시간 입력 필드에 직접 숫자 입력 (예: `18.0`)

### 5단계: 저장
1. 모달 하단의 **"💾 저장"** 버튼 클릭
2. 성공 메시지 확인: "✅ 타임스탬프가 저장되었습니다!"
3. 가사 목록에 변경사항이 즉시 반영됨

---

## 📸 화면 예시

### 편집 모드 비활성화 (기본)
```
[🙈 가사 숨기기] [🔁 반복 모드] [⚙️ 타임스탬프 편집]

가사 목록:
┌────────────────────────────────────┐
│ 1  Imagine there's no heaven       │
│    14.5s - 18.0s      [🔁] [⭐]    │
└────────────────────────────────────┘
```

### 편집 모드 활성화
```
[🙈 가사 숨기기] [🔁 반복 모드] [⚙️ 편집 중] ← 노란색

가사 목록:
┌────────────────────────────────────┐
│ 1  Imagine there's no heaven       │
│    14.5s - 18.0s            [⚙️]  │  ← 노란색 편집 버튼
└────────────────────────────────────┘
```

### 편집 모달
```
┌─────────────────────────────────────────────┐
│ ⏱️ 타임스탬프 편집                    [✕]  │
├─────────────────────────────────────────────┤
│                                             │
│  1  Imagine there's no heaven               │
│     천국이 없다고 상상해봐요                  │
│                                             │
│  현재 재생 시간: 14.50초                     │
│                                             │
│  시작 시간 (초)                              │
│  [14.5          ] [📍 현재 시간]            │
│                                             │
│  종료 시간 (초)                              │
│  [18.0          ] [📍 현재 시간]            │
│                                             │
│  구간 길이: 3.50초                           │
│  14.5초 ~ 18.0초                            │
│                                             │
│  💡 사용 방법:                               │
│  1. YouTube 영상을 해당 구절이 시작되는...   │
│                                             │
├─────────────────────────────────────────────┤
│                         [취소] [💾 저장]    │
└─────────────────────────────────────────────┘
```

---

## 💡 팁과 요령

### 정확한 타이밍 찾기
1. **재생 속도 조절**: YouTube 플레이어의 설정(⚙️) > 재생 속도 > 0.25x로 느리게 재생
2. **키보드 단축키 활용**:
   - `스페이스바`: 재생/일시정지
   - `← →`: 5초 앞뒤로 이동
   - `J K L`: 10초 뒤로, 일시정지, 10초 앞으로
   - `, .`: 프레임 단위로 뒤/앞으로 (일시정지 상태에서)

### 시작/종료 시간 기준
- **시작 시간**: 가사가 **처음 들리기 시작**하는 순간
- **종료 시간**: 해당 가사가 **완전히 끝나는** 순간 (다음 가사 시작 직전)

### 여러 가사 한 번에 수정
1. 첫 번째 가사의 타임스탬프를 정확히 설정
2. 나머지 가사는 **상대적인 간격**을 고려하여 조정
3. 한 곡의 모든 가사를 수정한 후, 처음부터 재생하여 전체 싱크 확인

---

## ⚠️ 주의사항

### 시간 형식
- **소수점 사용**: 14.5 (O) / 14:30 (X)
- **초 단위**: 분:초 형식 사용 불가
- **최소 단위**: 0.1초 (소수점 첫째 자리)

### 유효성 검사
- 종료 시간은 시작 시간보다 커야 함
- 시작 시간은 0 이상이어야 함
- 저장 시 자동으로 검증됨

### 데이터 저장
- **즉시 저장**: "💾 저장" 버튼 클릭 시 데이터베이스에 즉시 반영
- **취소 가능**: 저장하기 전에는 "취소" 버튼으로 변경 취소
- **영구 저장**: 한 번 저장하면 모든 사용자에게 적용됨

---

## 🔧 API 정보 (개발자용)

### 엔드포인트
```
PUT /api/lyrics/:id
```

### 요청 본문
```json
{
  "start_time": 14.5,
  "end_time": 18.0
}
```

### 응답
```json
{
  "id": 1,
  "song_id": 1,
  "line_number": 1,
  "text": "Imagine there's no heaven",
  "start_time": 14.5,
  "end_time": 18.0,
  "translation": "천국이 없다고 상상해봐요"
}
```

---

## 🐛 문제 해결

### Q: "📍 현재 시간" 버튼이 0.00초로 설정됨
**A:** YouTube 플레이어가 아직 준비되지 않았을 수 있습니다. 영상을 한 번 재생한 후 다시 시도하세요.

### Q: 저장 후에도 싱크가 맞지 않음
**A:** 브라우저 캐시를 지우고 페이지를 새로고침하세요 (Ctrl+Shift+R).

### Q: 타임스탬프가 저장되지 않음
**A:** 
1. 콘솔(F12)에서 에러 메시지 확인
2. 백엔드 서버가 실행 중인지 확인
3. 네트워크 연결 상태 확인

### Q: 편집 모드에서 가사를 클릭하면?
**A:** 편집 모드에서는 가사 클릭 시 재생되지 않고, ⚙️ 버튼만 작동합니다. 일반 모드로 전환하세요.

---

## 🎓 실전 예제

### 예제: "Imagine" 1번 가사 수정

**현재 상태**: 14.5초 ~ 18.0초  
**실제 영상**: 15.2초에 시작, 18.5초에 종료

**수정 절차**:
1. "⚙️ 타임스탬프 편집" 클릭
2. 1번 가사의 ⚙️ 버튼 클릭
3. YouTube에서 15.2초로 이동
4. "📍 현재 시간" (시작 시간) 클릭 → `15.2` 입력됨
5. YouTube에서 18.5초로 이동
6. "📍 현재 시간" (종료 시간) 클릭 → `18.5` 입력됨
7. "💾 저장" 클릭
8. 완료! 이제 15.2초~18.5초에 하이라이트됨

---

## 📊 업데이트 내역

- **v1.0** (2026-01-11): 타임스탬프 편집 기능 추가
  - UI 기반 편집 모달
  - "현재 시간" 버튼으로 간편 설정
  - 실시간 유효성 검증
  - 데이터베이스 즉시 저장

---

**마지막 업데이트**: 2026-01-11  
**작성자**: GenSpark AI Developer
